# wine-prediction
Develop Parallel machine learning (ML) application in AWS cloud platform using Python. 

1. Use Apache Spark to train an ML model in parallel on multiple EC2 instances. 
   Sidenote: Used pyspark alongside jupyter notebook to develop a wine prediction model
   
   
2. Used Spark's MLlib to develop and use an ML model in the cloud.



3. Created a container using docker in order to evaluate the model against new data sets.


<x>Model is trained in parallel on multiple instances or use AWS EMR.</x>

<y>After training the model, model is saved and loaded into an application/container that will perform the wine prediction and will run on one Linux EC2 instance. <br>
    In this particular case, rf_wine.model is the model generated by model training jupyter python notebook.</y>


<z>Input: there are 2 datasets used to train the ML model. <br>
      <r>  TrainingDataset.csv: dataset to train the model in parallel on multiple EC2 instances  <br> </r>
      <f>  ValidationDataset.csv: dataset to validate the model and optimize its performance</f>
</z>


<y>Input for prediction testing: TestDataset.csv <br>
    <a> Tests the functionality and perfromance of your prediction application. <br></a>
    <b> The prediction application will take this file as input from the local host.</b>
</y>

<y> Output: The output of your application will be a measure of the prediction performance, specifically the F1 score, which is available in MLlib</y>


<z>The environment is setup using flintrock and in 4 EC2 instances, using one as a master and 3 datanodes.</z>

<z> Submit the jupyter notebook to the master node and it will be executed in parallel.</z>

<z> The docker container may be found in the following link. [Wine Docker](https://hub.docker.com/r/jsnmorales/ubuntu_py_wine_pred)</z>

<z> Run the command on your linux instance:</z>
   <b> docker pull jsnmorales/ubuntu_py_wine_pred </b>


<y> In order to make predictions using this docker file you need to use the following code <br>

sudo docker run -v /home/ubuntu/file.csv:/home/ubuntu/test/file.csv ubuntu_py_wine_pred file.csv </y>
